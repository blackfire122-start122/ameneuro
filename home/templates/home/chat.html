{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Chat</title>
	<link rel="stylesheet" href="{% static 'home/css/chat.css' %}">
</head>
<body>
	<header class="back_header">
		<img onclick="window.history.back()" class="back_img" src="{% static 'home/images/back.png' %}" alt="">
		<h4 class="userregname">
			{% for n in chat.users.all %}
				{% if n != user %}
					{{ n }}
				{% endif %}
			{% endfor %}
		</h4>
		<div class="opt_mus">
<!-- 			<p>musick</p> -->
			<img onclick="chat_options(this)" class='img_opt' src="{% static 'home/images/options.png' %}" alt="">
		</div>
	</header>
	<div class="messages">
		{% for m in messages %}
			{% if m.type_m == 'msg' %}
				{% if m.user == user %}
					<div class="my_msgs">
						<p class="mes">{{ m }}</p>
						<time class='time'>{{ m.date }}</time>
					</div>
				{% else %}
					<div class="other_msgs">
						<p class="mes">{{ m }}</p>
						<time class='time'>{{ m.date }}</time>
					</div>
				{% endif %}

			{% else %}
				<div class="new_theme">
					<p class="mes">{{ m }}</p>
				</div>
			{% endif %}
		{% endfor %}
	</div>
	{% with end_mes=messages|last %}
		{% if end_mes.readeble %}
			<span class='readeble'>Read</span>
		{% else %}
			<span class='readeble'>not read</span>
		{% endif %} 
	{% endwith %}

	<span id="error"> {{ error }} </span>
	
	<div class="input_mes_send">
		<input placeholder='message' id="msg_user" type="text">
		<button id="btn_send" onclick="btn_send(this)">Send</button>
	</div>
	<div class="options"></div>
	<script>
		let user = "{{ user }}"
		let chat = "{{ chat }}"
		let chat_id = "{{ chat.id }}"
		let chat_options_ajax = "{% url 'chat_options_ajax' %}"
		let bg_inp_val = "{{ chat.theme.color_mes_bg }}"
		let chat_get_mess_ajax = "{% url 'chat_get_mess_ajax' %}"

	</script>
	<script src="{% static 'home/js/jquery-3.6.0.min.js' %}"></script>
	<script src="{% static 'home/js/chat.js' %}"></script>
	<style>
		body{
			background-image: url("{{ chat.theme.background.url }}");
			background-size: cover;
			background-repeat: round;
			background-attachment: fixed;
		}
		.messages{
			color: {{ chat.theme.color_mes }};
		}
		.my_msgs, .other_msgs{
			background: rgba({{ chat.theme.color_mes_bg }});
		}
	</style>
</body>
</html>	